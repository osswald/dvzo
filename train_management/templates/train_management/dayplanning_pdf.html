{% extends "base_pdf.html" %}
{% load i18n %}

{% block title %}{% translate "template.dayplanning.detail.title" %} - {{ object.label }}{% endblock %}

{% block content %}
<h1>Briefing {{object.label}} - {{object.date}}</h1>

<!-- TextblÃ¶cke -->
{% for dayplanning_text in dayplanning_texts %}
<p>
  {% autoescape off %}
    {{dayplanning_text.text}}
  {% endautoescape %}
</p>
{% endfor %}


<!-- Zugformation -->
<h3>Zugformation</h3>
<table class="table">
  <thead>
    {% for train_data in trains_data %}
    {% with train=train_data.train %}
    <th>{{train}}</th>
    {% endwith %}
    {% empty %}
    {% endfor %}
  </thead>
  <tbody>
    <tr>
      {% for train_data in trains_data %}
      {% with train=train_data.train %}
      <td>
        {% for vehicle in train.vehicles %}
          {% if vehicle.vehicle_type == "engine" %}
            <span class="badge bg-primary">{{ vehicle.label }}</span>
          {% elif vehicle.vehicle_type == "carriage" %}
            {% if vehicle.carriage_type == "seat" %}
              <span class="badge bg-secondary">{{ vehicle.label }}</span>
            {% elif vehicle.carriage_type == "gastro" %}
              <span class="badge bg-danger">{{ vehicle.label }}</span>
            {% else %}
              <span class="badge bg-dark">{{ vehicle.label }}</span>
            {% endif %}
          {% else %}
            peter
          {% endif %}<br>
        {% endfor %}
      </td>
      {% endwith %}
      {% empty %}
      {% endfor %}
    </tr>
  </tbody>
</table>

<!-- Personal -->

<h3>Personal</h3>
<table class="table table-sm">
  <thead>
    <th>Einsatzort</th>
    <th>Funktion</th>
    <th>Name</th>
    <th>Telefon</th>
  </thead>
  <tbody>
    {% for train_data in trains_data %}
    {% with train=train_data.train %}
    {% for function, persons in train_data.functions.items %}
    <tr>
      <td>{{train}}</td>
      <td>{{function}}</td>
      <td>
        {% for person in persons %}
          {{ person }}
          {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
      </td>
      <td>
        {% for person in persons %}
          {{ person.mobile_phone.as_national }}
          {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
      </td>
    </tr>
    {% endfor %}
    {% endwith %}
    {% empty %}
    {% endfor %}

    {% for function_type, functions in dayplanning_functions.items %}
    {% for function, persons in functions.items %}
    <tr>
      <td>{{function_type}}</td>
      <td>{{function}}</td>
      <td>
        {% for person in persons %}
          {{person}}
          {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
      </td>
      <td>
        {% for person in persons %}
          {{person.mobile_phone.as_national}}
          {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
      </td>
    </tr>
    {% endfor %}
    {% endfor %}
  </tbody>
</table>


{% endblock content %}

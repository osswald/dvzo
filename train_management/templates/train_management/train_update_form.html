{% extends "base.html" %}
{% load i18n %}

{% block content %}

<div class="container">
	<div class="row row-cols-lg-2">
		<div class="col container white-container">
			<h2>{% translate "Selected vehicles" %}</h2>
			<ul id="train" class="list-group">
				{% for vehicle in train.vehicles %}
				<li data-id="{{vehicle.id}}" class="list-group-item">{{vehicle}}</li>
				{% endfor %}
			</ul>
		</div>
		<div class="col container white-container">
			<h2>{% translate "Selected vehicles" %}</h2>
			<ul id="vehicles" class="list-group">
				{% for vehicle in available_vehicles %}
				<li data-id="{{vehicle.id}}" class="list-group-item">{{vehicle}}</li>
				{% endfor %}
			</ul>
		</div>
		<form id="orderingForm" method="post" action={{ request.get_full_path }}>
			{% csrf_token %}
			{% include 'includes/form.html' %}
			<input type="hidden" id="orderingInput" name="ordering">
		</form>
	</div>
	<button id="saveOrdering" class="btn btn-outline-primary btn-lg float-right mr-2">{% translate "Save" %}</button>
</div>


<script src="http://SortableJS.github.io/Sortable/Sortable.js"></script>
<script>
    var trainSortable = new Sortable.create(train, {
        group: 'train_group'
    });
    new Sortable.create(vehicles, {
        group: 'train_group'});

const saveOrderingButton = document.getElementById('saveOrdering');
const orderingForm = document.getElementById('orderingForm');
const formInput = orderingForm.querySelector('#orderingInput');

function saveOrdering() {
    formInput.value = trainSortable.toArray();
    orderingForm.submit();
}
saveOrderingButton.addEventListener('click', saveOrdering);
</script>
{% endblock content %}

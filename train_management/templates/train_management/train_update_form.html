{% extends "base.html" %}
{% load i18n %}

{% block content %}

<div class="container">
  <div class="row">
    <div class="col container white-container">
      <h1>{% translate "Edit train" %} </h1>
      <form id="orderingForm" method="post" action={{ request.get_full_path }}>
        {% csrf_token %}
        {% include 'includes/form.html' %}
        <input type="hidden" id="orderingInput" name="ordering">
      </form>
    </div>
  </div>
  <div class="row row-cols-lg-2">
    <div class="col container white-container">
      <h2>{% translate "Selected vehicles" %}</h2>
      <ul id="train" class="list-group" style="background-color: yellow">
        {% for vehicle in train.vehicles %}
          {% include 'includes/train_composition.html'%}
        {% endfor %}
      </ul>
    </div>
    <div class="col container white-container">
      <h2>{% translate "Available vehicles" %}</h2>
      <ul id="vehicles" class="list-group" style="background-color: yellow">
        {% for vehicle in available_vehicles %}
          {% include 'includes/train_composition.html'%}
        {% endfor %}
      </ul>
    </div>
  </div>
  <button id="saveOrdering" class="btn btn-primary ">{% translate "Save" %}</button>
</div>


<script src="http://SortableJS.github.io/Sortable/Sortable.js"></script>
<script>
    var trainSortable = new Sortable.create(train, {
        group: 'train_group'
    });
    new Sortable.create(vehicles, {
        group: 'train_group'});

    const saveOrderingButton = document.getElementById('saveOrdering');
    const orderingForm = document.getElementById('orderingForm');
    const formInput = orderingForm.querySelector('#orderingInput');

    function saveOrdering() {
        formInput.value = trainSortable.toArray();
        orderingForm.submit();
    }
    saveOrderingButton.addEventListener('click', saveOrdering);



</script>
{% endblock content %}
